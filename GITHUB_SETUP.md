# 🚀 Setting Up NeuralStark After Cloning from GitHub

This guide is for users who clone this repository from GitHub to their own Linux machine.

## ✨ What Makes This Setup Special

The NeuralStark is designed to be **fully portable** and work on **any Linux system** without hardcoded paths. All paths are automatically detected and configured based on where you clone the repository.

## 📋 Prerequisites

- A Linux system (Ubuntu, Debian, CentOS, RHEL, Fedora, or similar)
- Internet connection for downloading dependencies
- `sudo` access (for installing system packages)

## 🎯 Quick Start (2 Simple Steps)

### Step 1: Clone the Repository

```bash
git clone https://github.com/your-username/rag-platform.git
cd rag-platform
```

### Step 2: Run the Setup Scripts

```bash
# Make scripts executable
chmod +x post-clone-setup.sh run.sh

# Run initial setup
./post-clone-setup.sh

# Run the main setup and start the application
./run.sh
```

That's it! The scripts will handle everything automatically.

## 🔧 What the Scripts Do

### `post-clone-setup.sh`
This script prepares your cloned repository:
- ✅ Detects your project directory automatically
- ✅ Creates `.env` files with project-relative paths
- ✅ Creates necessary directories (`.cache/`, `.venv/`, `files/`, etc.)
- ✅ Makes all scripts executable
- ✅ No hardcoded paths - works anywhere you clone it

### `run.sh` - Universal Setup Script
This intelligent script:
- ✅ **Auto-detects your Linux distribution** (Ubuntu, Debian, CentOS, RHEL, Fedora)
- ✅ **Installs system dependencies** (Python, Node.js, MongoDB, Supervisor, OCR tools)
- ✅ **Creates Python virtual environment** in `.venv/` (within your project)
- ✅ **Installs all Python and Node.js dependencies**
- ✅ **Configures cache directories** within your project (`.cache/`)
- ✅ **Auto-generates `.env` files** with correct paths for your system
- ✅ **Configures and starts all services** (MongoDB, Backend, Frontend)
- ✅ **Verifies everything is working** before finishing

## 📁 Directory Structure After Setup

After running the setup scripts, your directory will look like this:

```
rag-platform/                    # Your cloned directory (can be anywhere)
├── .venv/                      # Python virtual environment (auto-created)
├── .cache/                     # Model and library cache (auto-created)
│   ├── huggingface/           # Hugging Face models cache
│   └── sentence_transformers/ # Sentence transformers cache
├── backend/
│   ├── .env                   # Auto-generated with your system's paths
│   ├── chroma_db/            # Vector database (auto-created)
│   └── ... (source files)
├── frontend/
│   ├── .env                   # Auto-generated with backend URL
│   └── ... (source files)
├── files/                      # Your documents go here (auto-created)
│   ├── company_info.md        # Sample document (created by run.sh)
│   ├── products.txt           # Sample document (created by run.sh)
│   └── faq.json              # Sample document (created by run.sh)
└── run.sh                     # The magic script that does it all
```

## 🌍 Path Resolution - How It Works

### The Old Way (Hardcoded - ❌ Bad)
```python
# This ONLY works if project is in /app
path = "/app/backend/chroma_db"  # ❌ Hardcoded
cache = "/app/.cache"            # ❌ Hardcoded
```

### The New Way (Dynamic - ✅ Good)
```python
# Works anywhere the project is cloned
from pathlib import Path
project_dir = Path(__file__).parent.parent  # Finds project root
path = project_dir / "backend" / "chroma_db"  # ✅ Relative
cache = project_dir / ".cache"                # ✅ Relative
```

## 🔐 Environment Variables

Both `.env` files are automatically generated by the setup scripts:

### Backend `.env`
```bash
# Auto-generated by run.sh with your actual project path
MONGO_URL="mongodb://localhost:27017"
DB_NAME="rag_platform"
CORS_ORIGINS="*"

# These are set to YOUR project directory, not hardcoded
HF_HOME="/your/path/to/rag-platform/.cache/huggingface"
TRANSFORMERS_CACHE="/your/path/to/rag-platform/.cache/huggingface"
SENTENCE_TRANSFORMERS_HOME="/your/path/to/rag-platform/.cache/sentence_transformers"
```

### Frontend `.env`
```bash
# Auto-configured based on your environment
REACT_APP_BACKEND_URL=http://localhost:8001
WDS_SOCKET_PORT=443
```

## 🎮 Using the Platform

### 1. Access the Application
Open your browser and go to:
```
http://localhost:3000
```

### 2. Configure Your API Key
- Go to the **Settings** page
- Add your Gemini API key
- Get one from: https://aistudio.google.com/app/apikey

### 3. Add Your Documents
Place your documents in the `files/` directory:
```bash
cp /path/to/your/document.pdf ./files/
```

The system supports:
- PDF files (with OCR)
- Word documents (.doc, .docx)
- Excel spreadsheets (.xls, .xlsx)
- Text files (.txt, .md)
- Data files (.json, .csv)
- OpenDocument (.odt)

### 4. Start Chatting
- Documents are automatically indexed
- Go to the Chat page
- Ask questions about your documents!

## 🔧 Managing Services

### Check Service Status
```bash
sudo supervisorctl status
```

### Restart Services
```bash
# Restart all services
sudo supervisorctl restart all

# Restart specific service
sudo supervisorctl restart backend
sudo supervisorctl restart frontend
```

### View Logs
```bash
# Backend logs
tail -f /var/log/supervisor/backend.err.log
tail -f /var/log/supervisor/backend.out.log

# Frontend logs
tail -f /var/log/supervisor/frontend.out.log
```

## 🐛 Troubleshooting

### Problem: Services won't start
**Solution:**
```bash
# Check what's using the ports
sudo lsof -i :8001  # Backend port
sudo lsof -i :3000  # Frontend port

# Check supervisor status
sudo supervisorctl status

# Check logs for errors
tail -50 /var/log/supervisor/backend.err.log
```

### Problem: Dependencies installation fails
**Solution:**
```bash
# Make sure you have internet connection
ping -c 3 google.com

# Try running the script again
./run.sh
```

### Problem: MongoDB won't start
**Solution:**
```bash
# Check MongoDB status
sudo systemctl status mongod

# Try starting manually
sudo systemctl start mongod

# Or with service command
sudo service mongod start
```

### Problem: "Permission denied" errors
**Solution:**
```bash
# Make scripts executable
chmod +x *.sh

# Check file ownership
ls -la

# If needed, fix ownership
sudo chown -R $USER:$USER .
```

## 📊 Verification

After setup completes, verify everything is working:

```bash
# Run the verification script
chmod +x verify-setup.sh
./verify-setup.sh
```

This will check:
- ✅ System dependencies
- ✅ Python environment and packages
- ✅ Frontend dependencies
- ✅ Service status
- ✅ API connectivity
- ✅ MongoDB connection

## 🔄 Re-running Setup

You can run `./run.sh` multiple times safely. It will:
- Detect existing setup and skip unnecessary steps
- Update dependencies if needed
- Reconfigure services if needed
- Not lose your data or settings

## 🎯 Key Benefits

1. **Portable**: Clone it anywhere, works anywhere
2. **No Hardcoded Paths**: All paths are relative to project directory
3. **Automatic Configuration**: .env files generated automatically
4. **Safe Re-runs**: Run setup script multiple times without issues
5. **Complete Isolation**: All dependencies in project directory
6. **Easy Cleanup**: Just delete the project directory

## 📚 Additional Resources

- **Detailed Setup Guide**: [FIRST_TIME_SETUP.md](FIRST_TIME_SETUP.md)
- **Configuration Details**: [PERMANENT_CONFIGURATION.md](PERMANENT_CONFIGURATION.md)
- **Troubleshooting Guide**: [TROUBLESHOOTING.md](TROUBLESHOOTING.md)
- **API Documentation**: See [README.md](README.md)

## 💡 Pro Tips

1. **Keep Everything in Project Directory**
   - All caches, venv, and data are self-contained
   - Easy to backup: just tar the whole directory
   - Easy to move: works in new location immediately

2. **Multiple Instances**
   - Clone to different directories for different projects
   - Each instance is completely independent
   - No conflicts between instances

3. **Updates**
   - Pull latest changes from git
   - Run `./run.sh` again to update dependencies
   - Your data and settings are preserved

## 🤝 Contributing

Found an issue? Have a suggestion? Feel free to:
- Open an issue on GitHub
- Submit a pull request
- Share your experience

## 📄 License

[Your License Here]

---

**Happy Document Chatting! 🚀📚💬**
